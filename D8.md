YARA Analysis\
**Objective**\
Create a YARA rule that will detect the target file. The target file has similar meta information identified in strelka.json. There are a total of 100 files, only one is the target file.\
**Walkthrough**\
We are given the command curl -H "Content-Type: text/plain" https://target- flask.chals.io/api/v1/yara-scan -X POST -d 'rule test {condition: true}' and a file strelka.json. If we run the command, the response is {"target_file":true,"total_matches":"100/100"}.
So we need to build a more specific YARA rule that will only detect the target file. We can look at the json file for information. We can start with a header byte check to only detect EXE files. So we add:\
rule test{condition: uint16be(0) == 0x4d5a}\
Running this, we still get 100 matches. We move on to something else. The scan results indicate that the file is a 32bit PE. We can add this to the rule:\
import "pe" rule test{condition:uint16be(0) == 0x4d5a and pe.is_32bit()}\
Still a 100 matches. From the scan we can also see pdb path in the debug information.\
import "pe" rule test{condition:uint16be(0) == 0x4d5a and pe.is_32bit() and pe.pdb_path == "C:\\Buildbot\\ad-windows-32\\build\\release\\app-32\\win_loader\\AnyDesk.pdb"}\
We still have a 100 matches! Other characteristics we can try to look for are compile timestamps.\
import "pe" rule test{condition: uint16be(0) == 0x4d5a and pe.is_32bit() and pe.pdb_path == "C:\\Buildbot\\ad-windows-32\\build\\release\\app-32\\win_loader\\AnyDesk.pdb" and pe.timestamp == 1713963204}\
6 matches!! We are getting somewhere. We can add the checksum, since each file is supposed to have a unique checksum, it can surely help.\
import "pe" rule test{condition: uint16be(0) == 0x4d5a and pe.is_32bit() and pe.pdb_path == "C:\\Buildbot\\ad-windows-32\\build\\release\\app-32\\win_loader\\AnyDesk.pdb" and pe.timestamp == 1713963204 and pe.checksum == 5359632}\
3 matches!! Let's try to clean it up a bit by removing the unnecessary checks that didn't filter the search down.\
import "pe" rule test{condition: uint16be(0) == 0x4d5a and pe.timestamp == 1713963204 and pe.checksum == 5359632}\
Success!!!!
We have the flag.
 
